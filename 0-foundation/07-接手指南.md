# 07｜接手指南

> 目标读者：第一次接触本环境的工程人员  
> 环境定位：**生产形态模拟，而非真实生产治理**  
> 核心目标：能独立跑通、修改、验证整个系统

---

## 1. 你接手的是什么

- **系统类型**：Mattermost 单机部署（模拟生产形态）
- **技术栈**：Docker Compose + Nginx + PostgreSQL
- **目标能力**：
  - 理解完整运行拓扑
  - 能修改配置并恢复
  - 能区分 prod / staging

> 本环境不追求：强审计、强发布治理、不可修改生产  
> 本环境追求：**技能闭环与环境理解**

---

## 2. 环境结构（必须先理解）

```text
mattermost/
├── environments/
│   ├── prod/
│   └── staging/
└── releases/
```

原则：

- prod / staging **数据、配置完全隔离**
- 两者结构保持高度一致
- 修改允许直接发生在 prod（这是训练环境）

---

## 3. 日常操作你需要会的

### 3.1 查看运行状态

```bash
cd environments/prod
docker compose ps
```

### 3.2 修改并重启服务

```bash
docker compose restart
```

### 3.3 查看日志

```bash
docker compose logs -f
```

---

## 4. 变更练习的正确方式

推荐顺序：

1. 在 staging 修改配置
2. 验证服务可启动
3. 对比 prod / staging 行为差异
4. 决定是否同步修改 prod

> 这是**技能训练路径**，不是治理流程。

---

## 5. 出问题时如何处理

基本原则：

- 不急着解释
- 先恢复服务
- 再定位原因

常见入口：

- Nginx → Mattermost 是否连通
- 数据目录是否被误删
- compose 文件是否有语法错误

---

## 6. 接手成功标准

你如果能做到：

- 清楚说明请求链路
- 独立修改配置并恢复
- 理解 prod / staging 的存在意义

即视为成功接手。
